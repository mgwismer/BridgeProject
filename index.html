<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

  <title>atomantic/JavaScript-Playing-Cards @ GitHub</title>

  <link rel="stylesheet" type="text/css" media="all" href="css/styles.css"/>
</head>

<body>
  <input type="button" id="dealCards" value="DEAL CARDS"/>
  <h2>Drawn Hands</h2> <br>
  <h3> <input type="button" id="northFlip" value="North Hand" /></h3>
  <div id="northHand" class="playingHand"></div> <br>
  <h3> <input type="button" id="eastFlip" value="East Hand" /> </h3>
  <div id="eastHand" class="playingHand"></div> <br>
  <h3> <input type="button" id="southFlip" value="South Hand" /> </h3>
  <div id="southHand" class="playingHand"></div> <br>
  <h3> <input type="button" id="westFlip" value="West Hand"/> </h3>
  <div id="westHand" class="playingHand"></div>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascript/playingCards.js"></script>
  <script type="text/javascript" src="javascript/playingCards.ui.js"></script>
  <script type="text/javascript">

    $(document).ready(function(){
      var cardRank = {
        Two: 0,
        Three: 1,
        Four: 2,
        Five: 3,
        Six: 4,
        Seven: 5,
        Eight: 6,
        Nine: 7,
        Ten: 8,
        Jack: 9,
        Queen: 10,
        King: 11,
        Ace: 12,
      }

      var bridgeHand = function() {
        this.spades = [];
        this.hearts = [];
        this.clubs = [];
        this.diamonds = [];
        //an array that includes all 13 cards
        this.completeHand = function() {
          return this.hearts.concat(this.spades).concat(this.diamonds).concat(this.clubs);
        }
        //sort within each suit according to rank
        this.sortHand = function() {
          this.spades.sort(this.compare);
          this.hearts.sort(this.compare);
          this.diamonds.sort(this.compare);
          this.clubs.sort(this.compare);
        }
        this.compare = function(a, b) {
          if (cardRank[a.rankString] < cardRank[b.rankString])
            return -1;
          if (cardRank[a.rankString] > cardRank[b.rankString])
            return 1;
          return 0;
        }
        this.addCardToHand = function(card) {
          switch (card.suit) {
            case "S":
              this.spades.push(card);
              break;
            case "D":
              this.diamonds.push(card);
              break;
            case "C":
              this.clubs.push(card);
              break;
            case "H":
              this.hearts.push(card);
              break;
          }
        }
      }

      var showError = function(msg){
        $('#error').html(msg).show();
        setTimeout(function(){
          $('#error').fadeOut('slow');
        },3000);
      }

      var showHand = function(hand,idName){
        var el = $('#'+idName);
        el.html('');
          for(var i=0;i<hand.length;i++){
            el.append(hand[i].getHTML());
            var allCards = document.getElementsByClassName("playingCard");
            var lastCard = allCards[allCards.length-1];
            lastCard.style.left = -i*65+"px";
          }
      }

      var doShuffle = function(){
        var cardDeck = new playingCards();
        console.log("new cards");
        cardDeck.shuffle();
        cardDeck.spread(); // update card table
      }

      var dealCards = function() { 
        console.log("button clicked");
        var cardDeck = $("#cardDeck").playingCards();
        var north = new bridgeHand;
        var south = new bridgeHand;
        var east = new bridgeHand;
        var west = new bridgeHand;
        for(var j = 0; j < 13; j++) {
          north.addCardToHand(cardDeck.draw());
          east.addCardToHand(cardDeck.draw());
          south.addCardToHand(cardDeck.draw());
          west.addCardToHand(cardDeck.draw());
        }
        north.sortHand();
        east.sortHand();
        south.sortHand();
        west.sortHand();
        showHands(north.completeHand(),east.completeHand(),south.completeHand(),west.completeHand());
      }

      function showHands(north,east,south,west) {
        showHand(north,"northHand");
        showHand(east,"eastHand");
        showHand(south,"southHand");
        showHand(west,"westHand");
      }

      function flipCards(direction) {
        var dirDiv = document.getElementById(direction);
        var c = dirDiv.getElementsByClassName("playingCard");
        for (var i = 0; i < c.length; i++) {
          var front = c[i].getElementsByClassName("front")[0];
          if (front.style.visibility == "hidden") {
            front.style.visibility = "visible";
          }
          else {
            front.style.visibility = "hidden";
          }
        }
      }

      var doOrderByRank = function(){
          cardDeck.orderByRank();
          cardDeck.spread(); // update card table
      }
      var doOrderBySuit = function(){
          cardDeck.orderBySuit();
          cardDeck.spread(); // update card table
      }
      $('#shuffler').click(doShuffle);
      $('#dealCards').click(dealCards);
      $('#northFlip').click(function() {
        flipCards("northHand");
      });
      $('#eastFlip').click(function() {
        flipCards("eastHand");
      });
      $('#southFlip').click(function() {
        flipCards("southHand");
      });
      $('#westFlip').click(function() {
        flipCards("westHand");
      });
  });
        /*
        // if we weren't using jquery to handle the document ready state, we would do this:
        if (window.addEventListener) {
            window.addEventListener("load",initPlayingCards,false);
        } else if (window.attachEvent) {
            window.attachEvent("onload",initPlayingCards);
        } else {
            window.onload = function() {initPlayingCards();}
        }
        function initPlayingCards() {
            cardDeck = new playingCards();
        }
        */
    </script>

</body>
</html>

